# COD 第六次作业

PB20111686 黄瑞轩

## 5.5

### 5.5.1

如果一个字为 $4$ 字节，由偏移位共有 $5$ 位知，一个块有 $2^5=32$ 个字节，所以一个块大小是 $8$ 字。

### 5.5.2

索引位共有 $5$ 位，所以 Cache 块共有 $2^5=32$ 个。

### 5.5.3

总容量为 $2^5\times(2^5\times8+54+1)=9952\rm{bits}$

数据容量为 $2^5\times(2^5\times8)=8192\rm{bits}$

比率为 $9952/8192=1.21$

### 5.5.4

以下均为二进制表示；标签前 52 位均为 0，省略。

|    访问地址    | 标签 | 索引  | 偏移  | 命中情况 |      替换情况      |
| :------------: | :--: | :---: | :---: | :------: | :----------------: |
| 0000 0000 0000 |  00  | 00000 | 00000 |   失效   |       初始化       |
| 0000 0000 0100 |  00  | 00000 | 00100 |   命中   |                    |
| 0000 0001 0000 |  00  | 00000 | 10000 |   命中   |                    |
| 0000 1000 0100 |  00  | 00100 | 00100 |   失效   |       初始化       |
| 0000 1110 1000 |  00  | 00111 | 01000 |   失效   |       初始化       |
| 0000 1010 0000 |  00  | 00101 | 00000 |   失效   |       初始化       |
| 0100 0000 0000 |  01  | 00000 | 00000 |   失效   |  替换 0x00 ~ 0x1f  |
| 0000 0001 1110 |  00  | 00000 | 11110 |   失效   | 替换 0x400 ~ 0x41f |
| 0000 1000 1100 |  00  | 00100 | 01100 |   命中   |                    |
| 1100 0001 1100 |  11  | 00000 | 11100 |   失效   |  替换 0x00 ~ 0x1f  |
| 0000 1011 0100 |  00  | 00101 | 10100 |   命中   |                    |
| 1000 1000 0100 |  10  | 00100 | 00100 |   失效   |  替换 0x80 ~ 0x9f  |

### 5.5.5

命中率 $=4/12=33\%$。

### 5.5.6

`<索引，标签，数据>`

`<4, 2, Mem[0x880]-Mem[0x89F]>`

`<0, 3, Mem[0xC00]-Mem[0xC1F]>`

`<5, 0, Mem[0xA0]-Mem[0xBF]>`

`<7, 0, Mem[0xE0]-Mem[0xFF]>`

## 5.11

下面假设地址是 32 位的，一个字是 4 字节。

### 5.11.1

每一组容量为 $48/3=16$ 字。

每个块大小为 $2$ 字，所以每一组共有 $16/2=8$ 块，所以索引位有 $3$ 位。

$2$ 字，偏移位有 $1$ 位。

剩下的 $32-3-1=28$ 位是标签。

数据宽度：$64$ 位。

![image-20220516142825658](C:/Users/10258/AppData/Roaming/Typora/typora-user-images/image-20220516142825658.png)

### 5.11.2

某路下面的表达方式：`<Pos, Tag>`，标签只列出最后四位。

| 字地址$_{16}$ | 字地址$_2$ | 标签 | 索引 | 偏移 | 命中情况 |               第一路                |     第二路     | 第三路  |
| :-----------: | :--------: | :--: | :--: | :--: | :------: | :---------------------------------: | :------------: | :-----: |
|      03       | 0000 0011  | 0000 | 001  |  1   |   失效   |               $<1,0>$               |                |         |
|      b4       | 1011 0100  | 1011 | 010  |  0   |   失效   |           $<1,0>\\<2,b>$            |                |         |
|      2b       | 0010 1011  | 0010 | 101  |  1   |   失效   |        $<1,0>\\<2,b>\\<5,2>$        |                |         |
|      02       | 0000 0010  | 0000 | 001  |  0   |   命中   |        $<1,0>\\<2,b>\\<5,2>$        |                |         |
|      be       | 1011 1110  | 1011 | 111  |  0   |   失效   |    $<1,0>\\<2,b>\\<5,2>\\<7,b>$     |                |         |
|      58       | 0101 1000  | 0101 | 100  |  0   |   失效   | $<1,0>\\<2,b>\\<5,2>\\<7,b>\\<4,5>$ |                |         |
|      bf       | 1011 1111  | 1011 | 111  |  1   |   命中   | $<1,0>\\<2,b>\\<5,2>\\<7,b>\\<4,5>$ |                |         |
|      0e       | 0000 1110  | 0000 | 111  |  0   |   失效   | $<1,0>\\<2,b>\\<5,2>\\<7,b>\\<4,5>$ |    $<7,0>$     |         |
|      1f       | 0001 1111  | 0001 | 111  |  1   |   失效   | $<1,0>\\<2,b>\\<5,2>\\<7,b>\\<4,5>$ |    $<7,0>$     | $<7,1>$ |
|      b5       | 1011 0101  | 1011 | 010  |  1   |   命中   | $<1,0>\\<2,b>\\<5,2>\\<7,b>\\<4,5>$ |    $<7,0>$     | $<7,1>$ |
|      bf       | 1011 1111  | 1011 | 111  |  1   |   命中   | $<1,0>\\<2,b>\\<5,2>\\<7,b>\\<4,5>$ |    $<7,0>$     | $<7,1>$ |
|      ba       | 1011 1010  | 1011 | 101  |  0   |   失效   | $<1,0>\\<2,b>\\<5,2>\\<7,b>\\<4,5>$ | $<7,0>\\<5,b>$ | $<7,1>$ |
|      2e       | 0010 1110  | 0010 | 111  |  0   |   失效   | $<1,0>\\<2,b>\\<5,2>\\<7,b>\\<4,5>$ | $<7,2>\\<5,b>$ | $<7,1>$ |
|      ce       | 1100 1110  | 1100 | 111  |  0   |   失效   | $<1,0>\\<2,b>\\<5,2>\\<7,b>\\<4,5>$ | $<7,2>\\<5,b>$ | $<7,c>$ |

### 5.11.3

没有偏移位，全部是标签。

数据宽度：$32$ 位。

![image-20220516144314847](C:/Users/10258/AppData/Roaming/Typora/typora-user-images/image-20220516144314847.png)

### 5.11.4

缓存内容用标签表示。

| 字地址$_{16}$ | 字地址$_2$ | 标签$_{16}$ | 命中情况 |            缓存内容            |
| :-----------: | :--------: | :---------: | :------: | :----------------------------: |
|      03       | 0000 0011  |     03      |   失效   |               03               |
|      b4       | 1011 0100  |     b4      |   失效   |             03, b4             |
|      2b       | 0010 1011  |     2b      |   失效   |           03, b4, 2b           |
|      02       | 0000 0010  |     02      |   失效   |         03, b4, 2b, 02         |
|      be       | 1011 1110  |     be      |   失效   |       03, b4, 2b, 02, be       |
|      58       | 0101 1000  |     58      |   失效   |     03, b4, 2b, 02, be, 58     |
|      bf       | 1011 1111  |     bf      |   失效   |   03, b4, 2b, 02, be, 58, bf   |
|      0e       | 0000 1110  |     0e      |   失效   | 03, b4, 2b, 02, be, 58, bf, 0e |
|      1f       | 0001 1111  |     1f      |   失效   | b4, 2b, 02, be, 58, bf, 0e, 1f |
|      b5       | 1011 0101  |     b5      |   失效   | 2b, 02, be, 58, bf, 0e, 1f, b5 |
|      bf       | 1011 1111  |     bf      |   命中   | 2b, 02, be, 58, bf, 0e, 1f, b5 |
|      ba       | 1011 1010  |     ba      |   失效   | 02, be, 58, bf, 0e, 1f, b5, ba |
|      2e       | 0010 1110  |     2e      |   失效   | be, 58, bf, 0e, 1f, b5, ba, 2e |
|      ce       | 1100 1110  |     ce      |   失效   | 58, bf, 0e, 1f, b5, ba, 2e, ce |

### 5.11.5

块大小为 2 字，所以偏移位需要 1 位。

数据长度：$64$ 位。

![image-20220516164849099](C:/Users/10258/AppData/Roaming/Typora/typora-user-images/image-20220516164849099.png)

### 5.11.6

缓存中每个块的内容表示为 `[word1, word2]`。

| 字地址$_{16}$ | 字地址$_2$ | 标签$_{16}$ | 偏移 | 命中情况 |        缓存内容（按栈形式排序）        |
| :-----------: | :--------: | :---------: | :--: | :------: | :------------------------------------: |
|      03       | 0000 0011  |     01      |  1   |   失效   |                [02, 03]                |
|      b4       | 1011 0100  |     5a      |  0   |   失效   |           [02, 03], [b4, b5]           |
|      2b       | 0010 1011  |     15      |  1   |   失效   |      [02, 03], [b4, b5], [2a, 2b]      |
|      02       | 0000 0010  |     01      |  0   |   命中   |      [b4, b5], [2a, 2b], [02, 03]      |
|      be       | 1011 1110  |     5f      |  0   |   失效   | [b4, b5], [2a, 2b], [02, 03], [be, bf] |
|      58       | 0101 1000  |     2c      |  0   |   失效   | [2a, 2b], [02, 03], [be, bf], [58, 59] |
|      bf       | 1011 1111  |     5f      |  1   |   命中   | [2a, 2b], [02, 03], [58, 59], [be, bf] |
|      0e       | 0000 1110  |     07      |  0   |   失效   | [02, 03], [58, 59], [be, bf], [0e, 0f] |
|      1f       | 0001 1111  |     0f      |  1   |   失效   | [58, 59], [be, bf], [0e, 0f], [1e, 1f] |
|      b5       | 1011 0101  |     5a      |  1   |   失效   | [be, bf], [0e, 0f], [1e, 1f], [b4, b5] |
|      bf       | 1011 1111  |     5f      |  1   |   命中   | [0e, 0f], [1e, 1f], [b4, b5], [be, bf] |
|      ba       | 1011 1010  |     5d      |  0   |   失效   | [1e, 1f], [b4, b5], [be, bf], [ba, bb] |
|      2e       | 0010 1110  |     17      |  0   |   失效   | [b4, b5], [be, bf], [ba, bb], [2e, 2f] |
|      ce       | 1100 1110  |     67      |  0   |   失效   | [be, bf], [ba, bb], [2e, 2f], [ce, cf] |

### 5.11.7

缓存中每个块的内容表示为 `[word1, word2]`。

| 字地址$_{16}$ | 字地址$_2$ | 标签$_{16}$ | 偏移 | 命中情况 |       缓存内容（按MRU策略排序）        |
| :-----------: | :--------: | :---------: | :--: | :------: | :------------------------------------: |
|      03       | 0000 0011  |     01      |  1   |   失效   |                [02, 03]                |
|      b4       | 1011 0100  |     5a      |  0   |   失效   |           [02, 03], [b4, b5]           |
|      2b       | 0010 1011  |     15      |  1   |   失效   |      [02, 03], [b4, b5], [2a, 2b]      |
|      02       | 0000 0010  |     01      |  0   |   命中   |      [b4, b5], [2a, 2b], [02, 03]      |
|      be       | 1011 1110  |     5f      |  0   |   失效   | [b4, b5], [2a, 2b], [02, 03], [be, bf] |
|      58       | 0101 1000  |     2c      |  0   |   失效   | [b4, b5], [2a, 2b], [02, 03], [58, 59] |
|      bf       | 1011 1111  |     5f      |  1   |   失效   | [b4, b5], [2a, 2b], [02, 03], [be, bf] |
|      0e       | 0000 1110  |     07      |  0   |   失效   | [b4, b5], [2a, 2b], [02, 03], [0e, 0f] |
|      1f       | 0001 1111  |     0f      |  1   |   失效   | [b4, b5], [2a, 2b], [02, 03], [1e, 1f] |
|      b5       | 1011 0101  |     5a      |  1   |   命中   | [2a, 2b], [02, 03], [1e, 1f], [b4, b5] |
|      bf       | 1011 1111  |     5f      |  1   |   失效   | [2a, 2b], [02, 03], [1e, 1f], [be, bf] |
|      ba       | 1011 1010  |     5d      |  0   |   失效   | [2a, 2b], [02, 03], [1e, 1f], [ba, bb] |
|      2e       | 0010 1110  |     17      |  0   |   失效   | [2a, 2b], [02, 03], [1e, 1f], [2e, ef] |
|      ce       | 1100 1110  |     67      |  0   |   失效   | [2a, 2b], [02, 03], [1e, 1f], [ce, cf] |

### 5.11.8

缓存中每个块的内容表示为 `[word1, word2]`。

| 字地址$_{16}$ | 字地址$_2$ | 标签$_{16}$ | 偏移 | 命中情况 |       缓存内容（按MRU策略排序）        |
| :-----------: | :--------: | :---------: | :--: | :------: | :------------------------------------: |
|      03       | 0000 0011  |     01      |  1   |   失效   |                [02, 03]                |
|      b4       | 1011 0100  |     5a      |  0   |   失效   |           [02, 03], [b4, b5]           |
|      2b       | 0010 1011  |     15      |  1   |   失效   |      [02, 03], [b4, b5], [2a, 2b]      |
|      02       | 0000 0010  |     01      |  0   |   命中   |      [02, 03], [b4, b5], [2a, 2b]      |
|      be       | 1011 1110  |     5f      |  0   |   失效   | [02, 03], [b4, b5], [2a, 2b], [be, bf] |
|      58       | 0101 1000  |     2c      |  0   |   失效   | [58, 59], [b4, b5], [2a, 2b], [be, bf] |
|      bf       | 1011 1111  |     5f      |  1   |   命中   | [58, 59], [b4, b5], [2a, 2b], [be, bf] |
|      0e       | 0000 1110  |     07      |  0   |   失效   | [0e, 0f], [b4, b5], [2a, 2b], [be, bf] |
|      1f       | 0001 1111  |     0f      |  1   |   失效   | [1e, 1f], [b4, b5], [2a, 2b], [be, bf] |
|      b5       | 1011 0101  |     5a      |  1   |   命中   | [1e, 1f], [b4, b5], [2a, 2b], [be, bf] |
|      bf       | 1011 1111  |     5f      |  1   |   命中   | [1e, 1f], [b4, b5], [2a, 2b], [be, bf] |
|      ba       | 1011 1010  |     5d      |  0   |   失效   | [1e, 1f], [b4, b5], [ba, bb], [be, bf] |
|      2e       | 0010 1110  |     17      |  0   |   失效   | [1e, 1f], [b4, b5], [2e, 2f], [be, bf] |
|      ce       | 1100 1110  |     67      |  0   |   失效   | [1e, 1f], [b4, b5], [ce, cf], [be, bf] |

