# 算法基础 HW10

黄瑞轩 PB20111686

## 1

（a）按如下步骤进行：

- 计算原网络和流的残存网络 —— $O(|E|)$
- 按给定边，增加 1 容量 —— $O(1)$
- 使用 BFS 搜索增广路径 —— $O(|V|)$
- 如果路径存在，则更新，否则不变 —— $O(1)$

所述的增广路径如果存在，流量最多增加 1，之后不需要继续操作了（上述过程最多一次）。所以这个算法的时间复杂度是 $O(|V|+|E|)$。

（b）按如下步骤进行：

- 计算原网络和流的残存网络 —— $O(|E|)$
- 如果减少容量的边没有用满容量，则减少 1 将不影响最大流 —— $O(1)$
- 如果用满了，按给定边减少 1 容量 —— $O(1)$
  - 使用 BFS 搜索包含减少的边的增广路径 —— $O(|V|)$
  - 如果路径存在，则更新，否则不变 —— $O(1)$

同理，这个算法的时间复杂度是 $O(|V|+|E|)$。

## 2

![](./2.svg)

注：数字相同代表同一个状态，对于一个数字所代表的状态需要把其在上图中的所有出现的出边、入边合并。

## 3

（1）让 $P[i],S[j]$ 这种表示字符的 ASCII 码，设通配符的 ASCII 码为 0，则定义匹配函数
$$
M(i,j)=(P[i]-S[j])^2P[i]S[j]
$$
定义完全匹配函数（为 0 则表示完全匹配）
$$
p(x)=\sum_{i=0}^{m-1}(P[i]-S[x-m+i+1])^2
$$
记 $P$ 的逆转字符串为 $R$，则
$$
\begin{aligned}
p(x)=&\sum_{i=0}^{m-1}(R[m-i-1]-S[x-m+i+1])^2\\
=&\sum_{i=0}^{m-1}R^2[m-i-1]+\sum_{i=0}^{m-1}S^2[x-m+i+1]-2\sum_{i=0}^{m-1}R[m-i-1]S[x-m+i+1]\\
=&\sum_{i=0}^{m-1}R^2[m-i-1]+\sum_{i=0}^{m-1}S^2[x-m+i+1]-2\sum_{i+j=x}R[i]S[j]
\end{aligned}
$$
若令 $h(x)=\sum_{i=0}^{m-1}R^2[m-i-1],f(x)=\sum_{i=0}^x S^2[i]$，则
$$
p(x)=h(x)+f(x)-f(x-m)-2\sum_{i+j=x}R[i]S[j]
$$
上面 $h(x),f(x)$ 都可以通过 $O(n)$ 的预处理完成（注意到 $m<<n$），只需要计算 $\sum_{i+j=x}R[i]S[j]$，这个可以用 FFT 做到 $O(x\log x)$，计算所有 $p(x)$ 就得到了题目要求的，所以总的时间复杂度是
$$
\sum_{x=0}^{n-m+1}x\log x=O(n\log n)
$$
（2）因为上面用 ASCII 码来表示字符了，所以（1）的方法可以直接应用于推广的问题。